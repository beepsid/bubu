<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#ff9a9e" />
    <title>Bubu üíï</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Arial", sans-serif;
        background: linear-gradient(
          135deg,
          #ff9a9e 0%,
          #fecfef 50%,
          #fecfef 100%
        );
        min-height: 100vh;
        padding: 40px 20px 160px 20px;
        overflow-x: hidden;
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
        color: white;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .header h1 {
        font-size: 32px;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 16px;
        opacity: 0.9;
      }

      .dashboard {
        max-width: 400px;
        margin: 0 auto;
        padding-bottom: 20px;
      }

      .feature-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 40px;
      }

      .feature-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 25px 15px;
        text-align: center;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .feature-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
      }

      .feature-card.full-width {
        grid-column: 1 / -1;
      }

      .feature-icon {
        font-size: 40px;
        margin-bottom: 10px;
        display: block;
      }

      .feature-title {
        font-size: 16px;
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
      }

      .feature-subtitle {
        font-size: 12px;
        color: #666;
      }

      .love-counter {
        background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
        color: white;
        text-align: center;
        padding: 20px;
        border-radius: 20px;
        margin-bottom: 20px;
        box-shadow: 0 8px 32px rgba(255, 107, 107, 0.3);
      }

      .counter-display {
        font-size: 48px;
        font-weight: bold;
        margin-bottom: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        padding: 10px;
        border-radius: 15px;
      }

      .counter-display:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: scale(1.05);
      }

      .input-modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      }

      .input-modal-content {
        background: white;
        padding: 30px;
        border-radius: 20px;
        text-align: center;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        max-width: 300px;
        width: 90%;
      }

      .input-modal h3 {
        color: #ff6b6b;
        margin-bottom: 20px;
        font-size: 20px;
      }

      .number-input {
        font-size: 24px;
        text-align: center;
        border: 2px solid #ff6b6b;
        border-radius: 10px;
        padding: 15px;
        width: 100%;
        margin-bottom: 20px;
        outline: none;
      }

      .number-input:focus {
        border-color: #ff8e8e;
        box-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
      }

      .modal-buttons {
        display: flex;
        gap: 10px;
        justify-content: center;
      }

      .modal-btn {
        padding: 12px 20px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .modal-btn.primary {
        background: #ff6b6b;
        color: white;
      }

      .modal-btn.primary:hover {
        background: #ff5252;
        transform: translateY(-2px);
      }

      .modal-btn.secondary {
        background: #f0f0f0;
        color: #666;
      }

      .modal-btn.secondary:hover {
        background: #e0e0e0;
      }

      .counter-label {
        font-size: 14px;
        opacity: 0.9;
        margin-bottom: 15px;
      }

      .counter-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
      }

      .counter-btn {
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        color: white;
        font-size: 24px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .counter-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.1);
      }

      .bottom-nav {
        position: fixed;
        bottom: 40px;
        left: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        padding: 15px;
        display: flex;
        justify-content: space-around;
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 20px;
        height: 70px;
        align-items: center;
        z-index: 100;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .nav-item {
        text-align: center;
        color: #666;
        text-decoration: none;
        font-size: 12px;
        transition: color 0.3s ease;
      }

      .nav-item.active {
        color: #ff6b6b;
      }

      .nav-icon {
        font-size: 24px;
        display: block;
        margin-bottom: 5px;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      .pulse {
        animation: pulse 2s infinite;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>Hey Beautiful! üê±</h1>
      <p>Your personal space made with love</p>
    </div>

    <div class="dashboard">
      <!-- Love Counter Section -->
      <div class="love-counter pulse">
        <div
          class="counter-display"
          id="counter"
          onclick="openNumberInput()"
          title="Click to enter number manually"
        >
          0
        </div>
        <div class="counter-label">
          Love slaps for talking shit about yourself üíï
        </div>
        <div class="counter-buttons">
          <button class="counter-btn" onclick="changeCount(-1)">-</button>
          <button class="counter-btn" onclick="changeCount(1)">+</button>
        </div>
      </div>

      <!-- Feature Grid -->
      <div class="feature-grid">
        <div class="feature-card" onclick="openFeature('calendar')">
          <span class="feature-icon">üå∏</span>
          <div class="feature-title">My Calendar</div>
          <div class="feature-subtitle">Period & mood tracker</div>
        </div>

        <div class="feature-card" onclick="openFeature('gallery')">
          <span class="feature-icon">üì∏</span>
          <div class="feature-title">Our Memories</div>
          <div class="feature-subtitle">Beautiful moments</div>
        </div>

        <div class="feature-card" onclick="openFeature('poems')">
          <span class="feature-icon">üìú</span>
          <div class="feature-title">My Poems</div>
          <div class="feature-subtitle">Written just for you</div>
        </div>

        <div class="feature-card" onclick="openFeature('diary')">
          <span class="feature-icon">üìù</span>
          <div class="feature-title">My Diary</div>
          <div class="feature-subtitle">Your thoughts</div>
        </div>

        <div class="feature-card full-width" onclick="openFeature('surprise')">
          <span class="feature-icon">üéÅ</span>
          <div class="feature-title">Special Surprise</div>
          <div class="feature-subtitle">Something just for you...</div>
        </div>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
      <a href="#" class="nav-item active">
        <span class="nav-icon">üè†</span>
        Home
      </a>
      <a href="#" class="nav-item">
        <span class="nav-icon">üå∏</span>
        Calendar
      </a>
      <a href="#" class="nav-item">
        <span class="nav-icon">üì∏</span>
        Gallery
      </a>
      <a href="#" class="nav-item" onclick="logout()">
        <span class="nav-icon">üö™</span>
        Logout
      </a>
    </div>

    <script>
      // Check authentication
      const userRole = localStorage.getItem("userRole");
      const userEmail = localStorage.getItem("userEmail");

      if (!userRole) {
        // Redirect to login if not authenticated
        window.location.href = "login.html";
      }

      // Update header based on role
      document.addEventListener("DOMContentLoaded", function () {
        const header = document.querySelector(".header h1");
        if (userRole === "boyfriend") {
          header.textContent = "Hey Handsome! üòé";
          document.querySelector(".header p").textContent =
            "Your girlfriend management dashboard";
        } else {
          header.textContent = "Hey Beautiful! üê±";
          document.querySelector(".header p").textContent =
            "Your personal space made with love";
        }

        // Update counter buttons based on role
        const counterButtons = document.querySelector(".counter-buttons");
        if (userRole === "girlfriend") {
          // Hide buttons for girlfriend - read only
          counterButtons.style.display = "none";

          // Add a sweet message
          const readOnlyMsg = document.createElement("div");
          readOnlyMsg.style.fontSize = "12px";
          readOnlyMsg.style.opacity = "0.8";
          readOnlyMsg.style.marginTop = "10px";
          readOnlyMsg.textContent = "Only your boyfriend can update this üòä";
          document.querySelector(".love-counter").appendChild(readOnlyMsg);
        }
      });

      // Load saved count on page load
      let count = parseInt(localStorage.getItem("count") || "0");
      document.getElementById("counter").innerText = count;

      function changeCount(amount) {
        // Only boyfriend can change count
        if (userRole !== "boyfriend") {
          alert("Only your boyfriend can update this counter! üòä");
          return;
        }

        count += amount;
        if (count < 0) count = 0; // Don't go below 0
        localStorage.setItem("count", count);
        document.getElementById("counter").innerText = count;

        // Add a little celebration for positive counts
        if (amount > 0) {
          createHeartAnimation();
        }

        // TODO: Later we'll sync this to Firebase so she sees it in real-time
      }

      function openNumberInput() {
        // Only boyfriend can change count
        if (userRole !== "boyfriend") {
          alert("Only your boyfriend can update this counter! üòä");
          return;
        }

        // Create modal
        const modal = document.createElement("div");
        modal.className = "input-modal";
        modal.innerHTML = `
          <div class="input-modal-content">
            <h3>üíï Set Love Counter</h3>
            <input 
              type="number" 
              class="number-input" 
              id="numberInput" 
              value="${count}" 
              min="0" 
              placeholder="Enter number..."
              inputmode="numeric"
            >
            <div class="modal-buttons">
              <button class="modal-btn primary" onclick="setNumber()">Set Number</button>
              <button class="modal-btn secondary" onclick="closeNumberInput()">Cancel</button>
            </div>
          </div>
        `;

        document.body.appendChild(modal);

        // Focus and select the input
        setTimeout(() => {
          const input = document.getElementById("numberInput");
          input.focus();
          input.select();
        }, 100);

        // Handle Enter key
        document
          .getElementById("numberInput")
          .addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              setNumber();
            }
          });

        // Handle Escape key
        document.addEventListener("keydown", function escapeHandler(e) {
          if (e.key === "Escape") {
            closeNumberInput();
            document.removeEventListener("keydown", escapeHandler);
          }
        });
      }

      function setNumber() {
        const input = document.getElementById("numberInput");
        const newCount = parseInt(input.value) || 0;

        if (newCount < 0) {
          alert("Number cannot be negative! üòä");
          return;
        }

        const oldCount = count;
        count = newCount;
        localStorage.setItem("count", count);
        document.getElementById("counter").innerText = count;

        // Add celebration if number increased
        if (newCount > oldCount) {
          createHeartAnimation();
        }

        closeNumberInput();

        // Show confirmation
        showNotification(`Love counter set to ${count}! üíï`);
      }

      function closeNumberInput() {
        const modal = document.querySelector(".input-modal");
        if (modal) {
          modal.remove();
        }
      }

      function showNotification(message) {
        const notification = document.createElement("div");
        notification.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: #28a745;
          color: white;
          padding: 15px 20px;
          border-radius: 10px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.2);
          z-index: 1001;
          font-size: 14px;
          font-weight: bold;
        `;
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
          notification.remove();
        }, 3000);
      }

      function createHeartAnimation() {
        const heart = document.createElement("div");
        heart.innerHTML = "üíï";
        heart.style.position = "fixed";
        heart.style.left = "50%";
        heart.style.top = "40%";
        heart.style.fontSize = "24px";
        heart.style.pointerEvents = "none";
        heart.style.zIndex = "1000";
        heart.style.animation = "heartFloat 1.5s ease-out forwards";

        document.body.appendChild(heart);

        setTimeout(() => {
          heart.remove();
        }, 1500);
      }

      // Add heart animation CSS
      const style = document.createElement("style");
      style.textContent = `
      @keyframes heartFloat {
        0% { 
          opacity: 1; 
          transform: translate(-50%, 0) scale(1); 
        }
        100% { 
          opacity: 0; 
          transform: translate(-50%, -100px) scale(1.5); 
        }
      }
    `;
      document.head.appendChild(style);

      function openFeature(feature) {
        // For now, just show an alert. We'll build these features next!
        const messages = {
          calendar:
            "üå∏ Period calendar coming soon! We'll make it super cute and helpful.",
          gallery:
            "üì∏ Photo gallery is in development! You'll be able to store all your favorite pics.",
          poems:
            "üìú My poems section coming up! All the poems I've written just for you.",
          surprise:
            "üéÅ The surprise isn't ready yet... but it's going to be amazing! üòâ",
        };

        if (feature === "calendar") {
          // Check if period setup is complete
          const periodData = JSON.parse(
            localStorage.getItem("periodSetupData")
          );

          if (!periodData || !periodData.setupComplete) {
            // Only girlfriend can set up period tracking
            if (userRole === "girlfriend") {
              window.location.href = "period-setup-new.html";
            } else {
              alert(
                "üå∏ Your girlfriend needs to set up her period tracking first! Ask her to open the calendar. üíï"
              );
            }
          } else {
            // Go to period calendar
            window.location.href = "period-calendar.html";
          }
          return;
        }

        if (feature === "diary") {
          window.location.href = "diary.html";
          return;
        }

        alert(messages[feature] || "This feature is coming soon! üíï");
      }

      // Logout function
      function logout() {
        if (confirm("Are you sure you want to logout? ü•∫")) {
          localStorage.removeItem("userRole");
          localStorage.removeItem("userEmail");
          window.location.href = "login.html";
        }
      }

      // Adjust for different screen sizes
      function adjustForScreenSize() {
        const screenHeight = window.innerHeight;
        const screenWidth = window.innerWidth;

        // Add more top padding for status bar
        document.body.style.paddingTop = "60px";

        // If it's a small screen, adjust bottom padding more
        if (screenHeight < 700) {
          document.body.style.paddingBottom = "180px";
        } else {
          document.body.style.paddingBottom = "160px";
        }

        // If it's a very wide screen, center better
        if (screenWidth > 500) {
          const dashboard = document.querySelector(".dashboard");
          if (dashboard) {
            dashboard.style.maxWidth = "450px";
          }
        }
      }

      // Call on load and resize
      window.addEventListener("load", adjustForScreenSize);
      window.addEventListener("resize", adjustForScreenSize);

      // Welcome message on first load
      if (!localStorage.getItem("welcomed")) {
        setTimeout(() => {
          alert(
            "Welcome to your special app, beautiful! üíï\n\nThis is made just for you with all my love. More features coming soon! üê±"
          );
          localStorage.setItem("welcomed", "true");
        }, 1000);
      }
    </script>
  </body>
</html>
